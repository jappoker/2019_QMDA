## Student Info

Jingyi Zhuang

jz2907@columbia.edu



## Homework 6

### (A)

<img src="/Users/freezer/Basement/2019Fall/Courses/EESC6908/2019_QMDA/HW6_Due1023/Screen Shot 2019-10-21 at 2.18.16 PM.png" alt="Screen Shot 2019-10-21 at 2.18.16 PM" style="zoom: 33%;" /> <img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191021142429269.png" alt="image-20191021142429269" style="zoom: 38%;" />

Yes, they match!

As mentioned in the instruction:

> Note that the Matlab SVD algorithm may have obtained the negative of any one of the singular vectors in in Figure 2.

Here in my plot of Mode 1 to 5, the 1, 2 and 5 are the negative $\mathbf{V_{mode_i}}$.

Script:

```matlab
% initiate variables

clearvars;
load('MOR_EOF_228_Z.mat');


% A. 

[U,S,V] = svd(Z,'econ');
x=linspace(-40,40,81);

figure(1);

for i = 1:5
    ax(i)=subplot( 'Position',[0.1 0.1+0.17*(5-i) 0.8 0.17]);
    
    % To match the paper Small 1998, the Mode 1, 2, 5 are -V(:i), and the
    % Mode 3 and 4 are V(:i), as mentioned in the problem instructions.
    
    if i == 1 || i ==2 || i == 5
        plot(x,-V(:,i),"k-","LineWidth",2);
    else
        plot(x,V(:,i),"k-","LineWidth",2);
    end
    
    % Make the ylim looks better:
    
    lim = max(abs(V(:,i)))/0.8;
    ylim([-lim,lim])
    legend(sprintf('Mode %g',i));

end

set(ax,'LineWidth',1,'FontSize',14,'YTickLabel','');
set(ax(1:4),'XTickLabel','');
xlabel('Distance(km)');
```



### (B)

Reproduce the main plot in Figure 2 of Small (1998):

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191021143253912.png" alt="image-20191021143253912" style="zoom:50%;" />



Script:

```matlab
% B.

var = diag(S);
var_ttl = sum(var);
var_percentage = var/var_ttl;


figure(2);
hold on;

plot(1:length(var_percentage), var_percentage, "ko-","MarkerSize",8,"LineWidth",2);
plot(1:5, var_percentage(1:5),"ko-","MarkerSize",8,"LineWidth",2,'MarkerFaceColor',"#000000");
text(20,0.1,sprintf('First 5 Sum is: %.3f',sum(var_percentage(1:5))),'FontSize',16 );
set(gca,'LineWidth',1,'FontSize',14);
xlabel('Mode');
ylabel('% Variance');
hold off;
```



### (C)

Why:

Because the singular value component refers to the same level as the data itself while the variance should be the square of that, the variance contribution of each mode is not calculated correctly by using $\%s_i = \frac{s_i}{\sum^N_1 s_j}$.

Instead, the variance contribution should be $\%s_i^2 = \frac{s_i^2}{\sum^N_1 s_j^2}$.

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191021143630738.png" alt="image-20191021143630738" style="zoom:50%;" />

So the corrected fraction of the total variance due to the first five singular vectors would be $0.844$.



Script:

```matlab
% C.

S2 = S^2;

var2 = diag(S2);
var2_ttl = sum(var2);
var2_percentage = var2/var2_ttl;

figure(3);
hold on;

plot(1:length(var2_percentage), var2_percentage, "ko-","MarkerSize",8,"LineWidth",2);
plot(1:5, var2_percentage(1:5),"ko-","MarkerSize",8,"LineWidth",2,'MarkerFaceColor',"#000000");
text(20,0.2,sprintf('First 5 Sum is: %.3f',sum(var2_percentage(1:5))),'FontSize',16 );
set(gca,'LineWidth',1,'FontSize',14);
xlabel('Mode');
ylabel('% Variance');

hold off;
```



### (D)

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191021143827953.png" alt="image-20191021143827953" style="zoom:50%;" />

The calculated $\mathbf{Z_p}$ file represents a smooth version of the original $\mathbf{Z}$ file and keeps the main tendency and characteristics of $\mathbf{Z}$ as well. It comfirms our knowledge that the factors, contributing most of the variance, can already represent the data very good, by ignoring the small variance. Thus, the $\mathbf{Z_p}$ shows better (= more obvious by eye) symmetric features around the ocean ridge ($x=0$km).

```matlab
% D.
% close all;

Sp = zeros(length(S),length(S));
Sp(1:5,1:5) = S(1:5,1:5);

Zp = U*Sp*V';

rows = [1 80 120];

figure(4);
for r = rows
    i = find(rows==r);
    axx(i)=subplot('Position',[0.1 0.1+0.3*(3-i) 0.8 0.3]);
    plot(x, Zp(i,:),"r-" ,  ...
         x,Z(i,:), "k-",...
         'LineWidth',2);
    legend(sprintf('%g row of Z',r),sprintf('%g row of Z_p',r))
end

set(axx,'LineWidth',1,'FontSize',14,'YTickLabel','');
set(axx(1:2),'XTickLabel','');
xlabel('Distance(km)');
```

