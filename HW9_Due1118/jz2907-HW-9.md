## Student Info

Jingyi zhuang

jz2907@columbia.edu

## Homework 8 Extra

![image-20191118184928692](/Users/freezer/Library/Application Support/typora-user-images/image-20191118184928692.png)

Here the differences between $T_{max}$ and $T_{min}$ in summers are bigger than that in winters. New York City lies in the warm humid subtropical climate zone, which is a zone of climate characterized by hot and humid summers, and cold to mild winters. (Citing https://en.wikipedia.org/wiki/Climate_of_New_York) Also the New York City is close to sea, which makes its summer night time able to reach a much lower temperature comparing to the daytime, thus, a bigger temperature difference.

##  Homework 9

### A.

![image-20191118135930333](/Users/freezer/Library/Application Support/typora-user-images/image-20191118135930333.png)

According to the semi-logarithmic diagram, there is a slight tendency for frequencies to decrease, so this is a red spectrum.

Yes there are peaks that are much more higher than the rests. The peaks are labeled in this image:

![image-20191118135955254](/Users/freezer/Library/Application Support/typora-user-images/image-20191118135955254.png)

The approximate peak frequencies and corresponding periods are:

| No   | Frequency (cycles/kyr) | Period (kyr) |
| ---- | ---------------------- | ------------ |
| 1    | 0.042042               | 23.786       |
| 2    | 0.044545               | 22.449       |
| 3    | 0.052553               | 19.028       |

Script:

```matlab
% initiate variables

clearvars;
load('QMDA_HW_09.mat');


% A.

d_ft = fft(d);
N = length(t);
Npos = N/2+1;
dt = t(2)- t(1);

fNyq=1/(2*dt);  % Nyquist frequency 
fpos=linspace(0,fNyq,Npos)';
fneg=flipud(-fpos(2:N/2));
freq=[fpos; fneg];

d_ft_pd = abs(d_ft).^2 ;

% figure for periodogram

figure(1);
subplot(2,1,1);
plot(fpos,d_ft_pd(1:Npos),'LineWidth',2);

ylabel('Periodogram');
xlabel('Frequency f');
set(gca,'FontSize',14);

subplot(2,1,2);
semilogy(fpos,d_ft_pd(1:Npos),'LineWidth',2);

ylabel('Periodogram in log space');
xlabel('Frequency f');
set(gca,'FontSize',14);
```



### B.

![image-20191118133303726](/Users/freezer/Library/Application Support/typora-user-images/image-20191118133303726.png)

In this diagram I put the tapers and the resulted new periodogram. With comparison to the figure in (A), this new perodogram is much smoother. The peaks are generally lower, with smaller amplitudes (the amplitude max at 10, compared to 280 in (A)), as the peaks are broadened.



Another diagram for More $N_W$ (and for the purpose to see period in detail, here the periodogram vs .$\log(period)$ is plotted on the right side, and the corresponding tapers are ploted on the left side as reference):

![image-20191118192911494](/Users/freezer/Library/Application Support/typora-user-images/image-20191118192911494.png)

We can see that the more tapers we are applying, the broader the peaks, and it even merges into one big wide peak for $N_W = 51$. As more tapers we use, the width of the tapers will be smaller (in the left part of this figure), thus, the large periods (low frequencies) are more likely to got washed out. 

While when we use less tapers, as $N_w = 3$ or $5$, the tapers have larger width, seperated peaks are more highlighted.



Script:

```matlab
% B.

Ntaper = 5;
deltataper =  round (N /  ((Ntaper+1)/2)/2);


% figure 2 for preview of tapers
figure(2);
clf;

subplot(3,1,1);

title(sprintf('Numer of tapers N_w = %g',Ntaper));
ylabel('Tapering function');
xlabel('Time t');
set(gca,'FontSize',14);

hold on;

h = zeros(N,Ntaper); % call an empty list for hanntapers;
d_h  = zeros(N,Ntaper);
d_ft_han = zeros(N,Ntaper); % call an empty list for fourier transform of the data applied hanntapers;
d_pd_han = zeros(N,Ntaper); % call an empty list for periodogram for d_ft_han

for i = 1:1:Ntaper
    h(:,i) = hanntaper(t,t(deltataper * i),deltataper);
    
    % calculate the d_ft_han per loop
    d_h(:,i) = h(:,i) .* d;
    d_ft_han(:,i) = fft(d_h(:,i));
    d_pd_han(:,i) = abs(d_ft_han(:,i) ).^2;
    
    % plot the hanntaper per loop
    plot(t,h(:,i),'LineWidth',2);
    hold on;
    
end


d_pd_han_avg = mean(d_pd_han,2);

subplot(3,1,2);

plot(fpos,d_pd_han_avg(1:Npos),'LineWidth',2);

xlabel('Frequency f');
ylabel('Periodogram');
set(gca,'FontSize',14);


subplot(3,1,3);
semilogy(fpos,d_pd_han_avg(1:Npos),'LineWidth',2);

xlabel('Frequency f');
ylabel('Periodogram');
set(gca,'FontSize',14);

% B. several N w's

figure(3);
clf;

Ntaper_list = [3, 5, 13, 25,51];
Ntaper_number = length(Ntaper_list);

for n = 1:1:Ntaper_number
    Nt = Ntaper_list(n);
    deltataper =  round (N /  ((Nt+1)/2)/2);

    % figure 2 for preview of tapers
    


    h = zeros(N,Nt); % call an empty list for hanntapers;
    d_h  = zeros(N,Nt);
    d_ft_han = zeros(N,Nt); % call an empty list for fourier transform of the data applied hanntapers;
    d_pd_han = zeros(N,Nt); % call an empty list for periodogram for d_ft_han

    for i = 1:1:Nt
        h(:,i) = hanntaper(t,t(deltataper * i),deltataper);

        % calculate the d_ft_han per loop
        d_h(:,i) = h(:,i) .* d;
        d_ft_han(:,i) = fft(d_h(:,i));
        d_pd_han(:,i) = abs(d_ft_han(:,i) ).^2;
    end

    d_pd_han_avg = mean(d_pd_han,2);

    figure(3);

    bx(n)= subplot( 'Position',[0.1 0.1+((1-0.15)/Ntaper_number)*(Ntaper_number-n) 0.3 (1-0.22)/Ntaper_number]);
    plot(t,h,'LineWidth',2);
    ylabel(sprintf('N_w = %g',Nt));
    
    
    ax(n)=subplot( 'Position',[0.43 0.1+((1-0.15)/Ntaper_number)*(Ntaper_number-n) 0.42 (1-0.22)/Ntaper_number]);
    semilogx(1./fpos,d_pd_han_avg(1:Npos),'LineWidth',2);
    xlabel('Period (kyr) in log space');

    legend(sprintf('Numer of tapers N_w = %g',Nt));
    set(gca,'FontSize',14);
    
end

set(ax,'LineWidth',1,'FontSize',14,'YAxisLocation', 'right');
set(ax(1:Ntaper_number-1),'XTickLabel','');
set(bx,'LineWidth',1,'FontSize',14,'YTickLabel','');
set(bx(1:Ntaper_number-1),'XTickLabel','');
```

### C.

By labelling the peaks out:

![image-20191118193028502](/Users/freezer/Library/Application Support/typora-user-images/image-20191118193028502.png)

The climatic precessions are observed in this spectral analysis, as the peaks at 19.04, 22.47, 23.8 in the unit of kyr are matched.

There appers to be no obvious peaks round 40-50 kyr for obliquity, or peaks around 90-130 kyr or 406 kyr for eccentricity.