## Student Info

Jingyi Zhuang

jz2907@columbia.edu

## HW 7

### A.

![image-20191028135823394](/Users/freezer/Basement/2019Fall/Courses/EESC6908/2019_QMDA/HW7_Due1030/image-20191028135823394.png)

Script:

```matlab
% initiate variables

clearvars;
load('QMDA_HW_07.mat');


% A.

figure(1);
plot(ti,hi, 'LineWidth',2);
xlabel('Time (Day)');
ylabel('Sea surface elevation (m)');
set(gca,'LineWidth',1,'FontSize',14);
```

### B.

Yes the data is sampled at a constant interval, $\Delta t =0.00416667$ in the unit of day.

The output of my script:

> The mean of the time interval 0.00416667, and the max and min of the dti are 0.00416667, 0.00416667

Since mean = max = min, the values in this array are the same.

Script:

```matlab
% B.

% To calculte the delta_t of sampling, we calculate the differenciate of ti

dtilist = diff(ti);

% to check if the time intervals are equal
dti = mean(dtilist);
fprintf('The mean of the time interval %g, and the max and min of the dti are %g, %g\n',dti, max(dtilist),min(dtilist));

```

### C.

``` matlab
% C.

% compute fourier coefficients
hft = fft(hi);

% compute vector of N +ve and -ve frequencies
N = length(ti);
Nf = N/2+1;
fNyq=1/(2*dti);  % Nyquist frequency 
fpos=linspace(0,fNyq,Nf)';
fneg=flipud(-fpos(2:N/2));
f=[fpos; fneg];
```



### D.

The plot of the periodogram vs. positive frequencies up to about 15 cycles/day:

![image-20191028141240015](/Users/freezer/Basement/2019Fall/Courses/EESC6908/2019_QMDA/HW7_Due1030/image-20191028141240015.png)

Script:

```matlab
% D.
% compute periodogram
pg = abs(hft).^2;

N1 = 2;
N15 = round(15/(2*dti));
% plot the periodogram
figure(2);
% semilogy - https://www.mathworks.com/help/matlab/ref/semilogy.html
semilogy(f(N1:N15),pg(N1:N15),'LineWidth',2);

title('Periodogram');
xlabel('Frequency cycles/day');
ylabel('Squared magnitude of hFFT');
set(gca,'LineWidth',1,'FontSize',14);
```

### E.

Here the peaks are labeled:

![image-20191030140223440](/Users/freezer/Basement/2019Fall/Courses/EESC6908/2019_QMDA/HW7_Due1030/image-20191030140223440.png)

| Frequencies (cycles/day) | Periods (days)                   |
| ------------------------ | -------------------------------- |
| 0.0027397                | 365.0                            |
| 0.041096                 | 24.33                            |
| 0.068493                 | 14.60                            |
| 0.92877                  | 1.077     $\approx$ 25.85 hours  |
| 1.0027                   | 0.9973   $\approx$ 23.85 hours   |
| 1.8959                   | 0.5275   $\approx$ 12.66 hours   |
| 1.9316                   | 0.5177   $\approx$ 12.42 hours   |
| 2                        | 0.5          $\approx$ 12 hours  |
| 3                        | 0.3333   $\approx$ 8 hours       |
| 3.8658                   | 0.2587   $\approx$ 6.209 hours   |
| 5                        | 0.2          $\approx$ 4.8 hours |
| 5.7973                   | 0.1725    $\approx$ 4.14 hours   |
| 7.7288                   | 0.1277    $\approx$ 3.064 hours  |

### F.

(A). Is there a peak in the spectrum that is more prominent than others? At what frequency and period?

Yes! The most prominent peak locates at frequency $= 1.9316$ cycles/day, which period is $0.5177$   day, $\approx 12.42$ hours.



(B). Can you explain the numeric value of the frequency and period of the most prominent peak?

The value is a little bit more than $0.5$ day, which suggests that the high and the low reach the same place every 12 hour and 25 minutes. There will be two highes and lows in one day, but they do not happen at the same time every day. There is a little laggacy, mostly due to the self-rotation of Earth and Moon. According to [Tides and Water Levels](https://oceanservice.noaa.gov/education/tutorial_tides/tides05_lunarday.html), this occurs because the moon revolves around the Earth in the same direction that the Earth rotates around its axis.



(C). Can you explain the numeric value of the frequency and period of the other peaks in the periodogram?

| Frequencies (cycles/day) | Periods (days)                  | **Species**                   | **DarwinSymbol** |
| ------------------------ | ------------------------------- | ----------------------------- | ---------------- |
| 0.0027397                | 365.0                           | Solar annual                  | $S_a$            |
| 0.041096                 | 24.33                           | Lunar monthly                 | $M_m$            |
| 0.068493                 | 14.60                           | Lunisolar synodic fortnightly | $M_{sf}$         |
| 0.92877                  | 1.077    $\approx$ 25.85 hours  | **Lunar diurnal** | $K_1$ |
| 1.0027                   | 0.9973   $\approx$ 23.85 hours  | Lunar diurnal (lunar-solar declinational) | $O_1$ |
| 1.8959                   | 0.5275   $\approx$ 12.66 hours  | Larger lunar elliptic semidiurnal | $N_2$ |
| 1.9316                   | 0.5177   $\approx$ 12.42 hours  | **Principal lunar semidiurnal** | $M_2$ |
| 2                        | 0.5          $\approx$ 12 hours | **Principal solar semidiurnal** | $S_2$ |
| 3                        | 0.3333   $\approx$ 8 hours      | Shallow water terdiurnal | $MK_3$ |
| 3.8658                   | 0.2587   $\approx$ 6.209 hours   | Shallow water overtides of principal lunar | $M_4$ |
| 5                        | 0.2          $\approx$ 4.8 hours | no match... |  |
| 5.7973                   | 0.1725    $\approx$ 4.14 hours   | Shallow water overtides of principal lunar | $M_6$ |
| 7.7288                   | 0.1277    $\approx$ 3.064 hours  | Shallow water eighth diurnal | $M_8$ |
Thanks a lot for [Theory of tides - wikipedia](https://en.wikipedia.org/wiki/Theory_of_tides).

The periods are closely related to the solar and lunar months and days.