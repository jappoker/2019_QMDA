## Student Info

Jingyi Zhuang

jz2907@columbia.edu



## Homework 5

A. 

Plot for data kernal G:

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191011142733734.png" alt="image-20191011142733734" style="zoom:50%;" />

Plot for $d_{obs}$:

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191011143129315.png" alt="image-20191011143129315" style="zoom:50%;" />

Commet:

The plot of kernal $\mathbf{G}$ shows that the data will be blurred by matrix $\mathbf{G}$ with moving the average, and blurred more when $x$ increases.

The plot of $d_{obs}$ shows that the data is more sin wave like at $x<50$, with obvious fluctuation at certain amplitude. When $x>50$, the wiggles occur due to the blur of data and noise.

Script:

```matlab
% initiate variables

clearvars;
load('QMDA_HW_05.mat');

% A. plot data kernal G & observed data a a function of x
%    plot initialization
figure(1);
clf;
axis ij;
set(gca,'LineWidth',1,'FontSize',14);
colormap(flipud(gray)*0.93);
hold on;

%    plot kernal G
imagesc(G);
colorbar;

%    figure settings
title('Kernal G');
xlim([1 M]);
ylim([1 N]);
ylabel("N");
xlabel("M");

%    plot d obs
figure(2);
set(gca,'LineWidth',1,'FontSize',14);
hold on;

plot(x,dobs,"ko-",'LineWidth',2,'MarkerSize',5);

%    figure settings
title('Observed data vs x');
ylabel(sprintf('d_{obs}'));
xlabel("x");
```



B.

Output:

```
The standard deviation of the data error \sigma_e = 0.0141605
```

Script:

```matlab
% B.

mest = (G'*G)\(G'*dobs);
e = dobs - G * mest;
E = e'*e;
sig2e = E/(N-1);
sige = sqrt(sig2e);

fprintf('the standard deviation of the data error \\sigma_e = %g\n',sigd);
```



C.

In generalized least squares,
$$
\mathbf{\mu_{post}} = \mathbf{\mu_{prior}} + (\mathbf{\Sigma_{prior}^{-1}} + \mathbf{G}^T \mathbf{\Sigma_{e}^{-1}} \mathbf{G} )^{-1} \mathbf{G}^T \mathbf{\Sigma_{e}^{-1}} (\mathbf{d_{obs}} - \mathbf{G}\mathbf{\mu_{prior}}),
\\
\mathbf{\Sigma_{post}} = (\mathbf{\Sigma_{prior}^{-1}} + \mathbf{G}^T \mathbf{\Sigma_{e}^{-1}} \mathbf{G} )^{-1}
$$
From the C. conditions we know $\mathbf{\mu_{prior}} = 0$.

C.1

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191014164633531.png" alt="image-20191014164633531" style="zoom:50%;" />

C.2

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191014164617061.png" alt="image-20191014164617061" style="zoom:50%;" />

Script:

```matlab
% C.

close all;

I = eye(N);
Cov_e = sig2_e * I;
Mu_prior = zeros(N,1);

% Guess

sig_m = 0.4;
Cov_prior = sig_m ^2 * I;

% Calculation 

Mu_post = Mu_prior + inv (inv( Cov_prior) +G' * inv(Cov_e) * G) * G' * inv(Cov_e) * (dobs - G * Mu_prior);
Cov_post = inv (inv( Cov_prior) + G' * inv(Cov_e) * G);
sig2_post = diag(Cov_post);
sig_post = sqrt(sig2_post);

% C.1 figure
figure(3);
set(gca,'LineWidth',1,'FontSize',14);
hold on;

plot(x,Mu_post,"-",'LineWidth',2,'MarkerSize',5);
plot(x,Mu_post + sig_post*2 ,":",'LineWidth',2,'MarkerSize',5);
plot(x,Mu_post - sig_post*2,":",'LineWidth',2,'MarkerSize',5);

legend({ sprintf('\\mu_{post}'),  sprintf('\\mu_{post} + 2\\sigma')  , sprintf('\\mu_{post} - 2\\sigma') });
xlabel('x');
title(sprintf('\\mu_{post} with guess \\sigma_m = %g', sig_m));

% C.2 figure
figure(4);
set(gca,'LineWidth',1,'FontSize',14);
hold on;

plot(x,dobs,"o",'LineWidth',2,'MarkerSize',5);
plot(x,G*Mu_post, "-",'LineWidth',2 );

legend({ sprintf('d_{obs}'), sprintf('d_pred = G\\mu_{post}')})
title(sprintf('Data and predictions with guess \\sigma_m = %g', sig_m));
```



D.

$\sigma_e$ becomes small:

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191014170101914.png" alt="image-20191014170101914" style="zoom:50%;" />

$\sigma_e$ becomes large:

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191014172443181.png" alt="image-20191014172443181" style="zoom:50%;" />

So from changing $\sigma_e$ we can see: decreasing $\sigma_e$ will make the fitting curve of prediction become more close to the observed data, but also makes the post mean have lots of wiggle.

Increasing $\sigma_e$ will make the post mean become very smooth,

> 写！！！！！！！

$\sigma_m$ becomes small:

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191014172641578.png" alt="image-20191014172641578" style="zoom:50%;" />

$\sigma_m$ becomes large:

<img src="/Users/freezer/Library/Application Support/typora-user-images/image-20191014172513597.png" alt="image-20191014172513597" style="zoom:50%;" />

> 写



E. 

不知道

